@using BlazorApp.Shared

@inject Blazored.LocalStorage.ILocalStorageService localStorage

<h3>@ItemToTrack.Name</h3>

@if (ItemToTrack.PastOccurrences.Any())
{
    <p>@ItemToTrack.PastOccurrences.Count</p>

    <p>Last Tracked: @ItemToTrack.PastOccurrences.Select(a => a.ActualTimestamp).Max()</p>
}

<p>Next Occurrences:</p>
<ol>
    @foreach (var occurrence in ItemToTrack.GetFutureOccurrences(DateTime.UtcNow, 5))
    {
        <li>@occurrence</li>
    }
</ol>

<button @onclick="OnClick">Track</button>

@code {
    void OnClick()
    {
        ItemToTrack.AddOccurrence(DateTime.UtcNow);
        localStorage.SetItemAsync(nameof(TrackedItem) + ItemToTrack.Name, ItemToTrack);
    }

    [Parameter]
    public TrackedItem ItemToTrack { get; set; }
}
